# Judge - 关键词批量提取AI工具

## 简介

Judge 是一款基于大语言模型，批量提取文档关键词的 macOS 应用程序，写这款程序一开始是为了批量提取裁判书中的关键词。
但理论上，只要关键词设置好，可用于批量提取任何主题的 `.txt` / `.docx` 文本。


## 注意
- 该软件需要用户自己去大语言模型官网获取有效的API密钥，并填入本软件的相应位置。
- 本软件的作用是实现可视化的批量操作，并存入.csv文件，并不实际解析文档，解析功能由用户所使用的大语言模型工具实现。


## 主要功能

- ✅ **智能文档处理**：支持 `.txt` 和 `.docx` 格式的裁判文书。
- ✅ **AI 分析**：目前仅集成了 DeepSeek 和 ZhipuAI两款模型的调用接口。质谱AI的“glm-4-flash”目前官方免费调用，可用于测试。
- ✅ **双模式支持**：
  - **关键词模式**：只需要在输入框内填入你想从文档中提取的数个关键词，适合小白入门。
  - **JSON 模式**：返回结构化的 JSON 数据，适合专业人士。
- ✅ **模型配置管理**：保存多个 AI 服务和模型的预设配置，快速切换。
- ✅ **Prompt 历史记录**：自动保存 JSON 模式下的 prompt，支持快速调用历史记录。
- ✅ **批量处理**：自动处理文件夹中的所有文档。
- ✅ **进度控制**：支持暂停、继续、停止操作。
- ✅ **CSV 导出**：自动将提取的信息保存为 CSV 格式。
- ✅ **持久化配置**：自动保存和恢复设置（包括 API Key）。

## 系统要求

- macOS 13.0 或更高版本
- 64 位 Intel 或 Apple Silicon
- 网络连接（用于 AI API 调用）

## 安装方法

### 安装步骤

1. **打开 DMG 文件**
   - 双击下载的dmg 文件
   - 磁盘镜像将会挂载并打开窗口

2. **安装应用**
   - 将 `Judge.app` 拖动到 `Applications` 文件夹快捷方式
   - 等待复制完成

3. **启动应用**
   - 从"启动台"搜索 Judge 并打开
   - 或从"应用程序"文件夹中打开
   - 或使用 Spotlight 搜索 "Judge"

4. **推出磁盘镜像**
   - 右键点击桌面上的磁盘图标
   - 选择"推出"

### 首次运行

首次打开时，macOS 可能提示"无法打开"或"来自未知开发者"。解决方法：

**方法 1（推荐）**：
1. 打开"系统设置" → "隐私与安全性"
2. 找到 Judge 的提示信息
3. 点击"仍要打开"按钮

**方法 2**：
1. 右键点击 `Judge.app`
2. 选择"打开"
3. 在弹出的对话框中点击"打开"

**方法 3（终端命令）**：
```bash
xattr -cr /Applications/Judge.app
```


## 使用方法

### 1. 配置模型

**首次使用**：
1. 点击"管理模型"按钮打开配置界面
2. 点击"添加配置"创建新的模型配置
3. 输入配置名称（如"我的 DeepSeek"）
4. 选择平台（DeepSeek 或 ZhipuAI）
5. 输入模型名称（如deepseek-chat）和 API Key
6. 如果使用 ZhipuAI，可选择启用思考模式，该模式下运行时间会变长。DeepSeek的思考模式需将模型名称由deepseek-chat改为deepseek-reasoner。
7. 点击"保存"

**切换配置**：
- 在主界面的"模型配置"下拉菜单中选择已保存的配置
- 配置会自动加载对应的服务类型、模型和 API Key

**管理配置**：
- 点击"管理模型"按钮可查看所有配置
- 悬停在配置上会显示编辑和删除按钮
- 点击配置名称可快速选择
- 配置按最后使用时间排序

### 2. 设置输入输出

1. 点击"浏览..."按钮选择包含裁判文书的输入文件夹
2. 点击"另存为..."按钮选择输出 CSV 文件位置

### 3. 配置提取规则

**关键词模式**（适合小白入门）：
- 设置关键词数量
- 输入需要提取的关键词（如"案号"、"原告"、"被告"等）
- 程序会按照固定模板提取信息

**JSON 模式**（高级用户，对输出格式要求高）：
- 开启"JSON 模式"开关
- 输入自定义的 JSON 提示词
- 点击"历史记录"按钮可以快速选择之前使用过的 prompt
- AI 将返回结构化的 JSON 数据

#### JSON 模式使用示例

**使用场景**：需要精确提取特定字段，或者需要复杂的数据结构输出。可借助AI工具将下列示例输给AI，让它作为模板，生成你的prompt。

**示例：提取刑事案件案号的 Prompt**

将以下内容复制到 JSON 提示词文本框中：

```
你是一位专业的司法数据分析师，任务是从中国的刑事裁判文书中，精确提取"案号"。

请严格遵循以下指令，分析提供的文书：

### 指令：
1. **识别案号**: 从文书的标题或首部，找到格式为 "（XXXX）[省份简称][法院代码]刑初XXXX号" 或类似格式的案号。
2. **精确提取**: 只提取案号本身，确保包含括号和所有字符。
3. **处理缺失**: 如果文书中实在找不到案号，则输出 "未提及"。
4. **输出格式**: 结果必须以一个单一、干净、不含任何额外解释的JSON对象格式输出。

### 示例：
**输入文书片段:**
"上海市金山区人民法院
刑 事 判 决 书
（2023）沪0116刑初44号
公诉机关上海市金山区人民检察院。..."

**对应的正确输出:**
{
  "case_number": "（2023）沪0116刑初44号"
}

现在请分析以下文书内容：
```

### 4. 开始处理

1. 点击"开始处理"按钮
2. 实时查看进度和状态
3. 可随时暂停、继续或停止
4. 处理完成后点击"打开文件夹"查看结果

## 功能特点

### 智能重命名
如果输出文件已存在，程序会自动重命名为 `output_1.csv`、`output_2.csv` 等，避免覆盖。


### 日志系统
所有操作都会记录日志，位于：
```
~/Library/Application Support/Judge/log.txt
```

### 配置文件
配置自动保存在：
```
~/.ws_app_config.json
```

### Prompt 历史记录
JSON 模式的 prompt 历史记录保存在：
```
~/Library/Application Support/Judge/prompt_history.json
```

### 模型配置
模型配置保存在：
```
~/Library/Application Support/Judge/model_configs.json
```

支持的功能：
- 保存多个模型配置（服务类型 + 模型名称 + API Key）
- 每个配置包含名称、服务类型、模型、API Key、思考模式等信息
- 自动记录最后使用时间，按使用频率排序

特点：
- 自动保存使用过的 JSON prompt
- 最多保存 20 条记录
- 支持删除单条或清空所有记录
- 点击"历史记录"按钮快速选择

## 技术栈

- Swift 5
- SwiftUI
- Combine
- URLSession（流式 HTTP）


## 联系作者

QQ: 592781468

## 授权说明

**当前版本授权期限**：至 2025年12月31日

- ✅ 授权期内可正常使用所有功能
- ❌ 到期后将显示过期提示并无法使用
- 📧 如需续期，请联系开发者

应用启动时会自动检查系统日期，过期后将无法访问任何功能。

## 许可证

保留所有权利 © 2025
